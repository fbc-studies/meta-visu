!function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},a=function(){var t=h(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(e).then(function(t){return t.json()}).then(function(t){return t}));case 1:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),i=function(){var t=h(regeneratorRuntime.mark(function t(e){var n,i,o,s,c,l,d,f,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a("data/"+e);case 2:n=t.sent,i=n.registers.filter(function(t){return!h.includes(t.name)}),n.registers=i,n=g(n),o=m(n),c={width:450,height:s=100*o,posX:125,posY:50,childrenNames:["registers","categories"],animationDuration:750,nodeSize:7.5},l=d3.select('body>div[data-filename="'+e+'"]').append("svg").attr("data-filename",e).attr("height",s+100).attr("width",1050).attr("class","timeline-tree js-timeline-tree"),(d=new u.default(n,l,c)).updateNodes(),d.updateLinks(),f={width:250,height:100,showXAxis:!1,showLegend:!1,scaleStartDate:new Date("1950-1-1")},d.treeData.children.forEach(function(t,e){t.children.forEach(function(n,a){var i=f;e===d.treeData.children.length-1&&a===t.children.length-1&&(i=r({},f,{showXAxis:!0,showLegend:!0}));var o=v(n.data.samplings,l,i);o.moveTo(n.y+300,n.x+12.5),o.update()})});case 15:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),o=function(){var t=h(regeneratorRuntime.mark(function t(e,n){var r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a("data/"+n);case 2:r=g(r=t.sent),(i=document.createElement("ul")).classList.add("register-selector"),r.registers.forEach(function(t){var e=n+"/"+t.name,r=document.createElement("li");r.classList.add("register__item"),r.innerHTML='<input class="js-register-select" type="checkbox" id="'+e+'" \n    data-identifier="'+e+'" checked/>\n    <label for="'+e+'">'+t.name+"</label>",i.appendChild(r)}),e.appendChild(i),w(i);case 9:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),s=function(){var t=h(regeneratorRuntime.mark(function t(e,n){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:null===(r=e.querySelector(".register-selector"))?o(e,n):r.classList.remove("vanish");case 2:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),c=function(){var t=h(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a("data/filenames.json");case 2:(e=t.sent).sort(),b(e),x(e),document.querySelectorAll(".js-btn").forEach(function(t){t.addEventListener("click",function(){var e=t.dataset.filename;[].concat(f(t.classList)).includes("btn--selected")?(y(e),function(t){t.querySelector(".register-selector").classList.add("vanish")}(t.parentElement),t.classList.remove("btn--selected")):(t.classList.add("btn--selected"),i(e),s(t.parentElement,e))})}),document.querySelector(".js-show-menu").addEventListener("click",function(){document.querySelector(".js-nav-menu").classList.remove("hidden")}),document.querySelector(".js-hide-menu").addEventListener("click",function(){document.querySelector(".js-nav-menu").classList.add("hidden")}),document.querySelector('.js-btn[data-filename="National Institute for Health and Welfare.json"]').click(),document.querySelector(".js-show-menu").click();case 11:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),u=d(n(1)),l=d(n(2));function d(t){return t&&t.__esModule?t:{default:t}}function f(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function h(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function r(a,i){try{var o=e[a](i),s=o.value}catch(t){return void n(t)}if(!o.done)return Promise.resolve(s).then(function(t){r("next",t)},function(t){r("throw",t)});t(s)}("next")})}}function p(t,e){return t.name<e.name?-1:t.name>e.name?1:0}function g(t){return t.registers.sort(function(t,e){return p(t,e)}),t.registers.forEach(function(t){return t.categories.sort(function(t,e){return p(t,e)})}),t}function m(t){var e=0;return t.registers.forEach(function(t){return t.categories.forEach(function(t){return e+=1})}),e}function v(t,e,n){var r=t;return r=[{type:"parents",data:r.filter(function(t){return t.parents})},{type:"subjects",data:r.filter(function(t){return!t.parents})}],new l.default(r,e,n)}function y(t){var e=document.querySelector('.js-timeline-tree[data-filename="'+t+'"]');e&&e.remove()}function x(t){t.map(function(t){return t.split(".")[0]}).sort().forEach(function(t){var e=document.createElement("li");e.classList.add("nav__item"),e.innerHTML='<button class="btn js-btn" data-filename="'+t+'.json">'+t+"</button>",document.querySelector(".js-nav-list").appendChild(e)})}function w(t){t.querySelectorAll(".js-register-select").forEach(function(e){e.addEventListener("change",function(){var n=e.dataset.identifier.split("/")[0],r=[].concat(f(t.querySelectorAll(".js-register-select"))).filter(function(t){return!t.checked}).map(function(t){return t.dataset.identifier.split("/")[1]});y(n),i(n,r)})})}function b(t){t.forEach(function(t){var e=document.createElement("div");e.classList.add("timeline-tree-wrapper"),e.dataset.filename=t,document.querySelector("body").appendChild(e)})}c()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var a=function(){function t(e,n,r){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config={width:r.width?r.width:400,height:r.height?r.height:200,posX:r.posX?r.posX:0,posY:r.posY?r.posY:0,childrenNames:r.childrenNames?r.childrenNames:["registerAdmins","registers","categories","samplings"],nodeSize:r.nodeSize?r.nodeSize:10,animationDuration:r.animationDuration?r.animationDuration:750};var i=this.config.height,o=this.config.width,s=d3.tree().size([i,o]).separation(function(){return 1}),c=d3.hierarchy(e,function(t){return a.findChildArr(t)});this.treeData=s(c),this.svg=n.append("g").attr("class","tree").attr("width",this.config.width).attr("height",this.config.height).attr("transform","translate("+this.config.posX+", "+this.config.posY+")").append("g"),this.sourceCoord={x:i/2,y:0},this.idCounter=0}return r(t,[{key:"findChildArr",value:function(t){var e=this.config.childrenNames.filter(function(e){return void 0!==t[e]})[0];return void 0!==e?t[e]:null}},{key:"drawNodeCircles",value:function(t){t.append("circle").attr("class","tree__node-marker").attr("r",this.config.nodeSize)}},{key:"moveNodesInPlace",value:function(t){t.attr("transform",function(t){return"translate("+t.y+", "+t.x+")"})}},{key:"addNodeLabels",value:function(t){var e=this;t.filter(function(t){return t.parent}).append("text").attr("class","tree__node-label").attr("dy",function(t){return e.constructor.calculateLabelPlacement(t)}).attr("x",-13).attr("text-anchor","middle").text(function(t){return t.data.name}),this.addRootLabel(t.filter(function(t){return!t.parent}))}},{key:"addRootLabel",value:function(t){var e=t.append("foreignObject").attr("class","tree__html-object"),n=e.append("xhtml:p").attr("class","tree__html-label").html(function(t){return t.data.name}).node().getBoundingClientRect();e.attr("transform","translate("+-1*n.width+", "+n.height/-2+")")}},{key:"updateNodes",value:function(){var t=this,e=this.treeData.descendants(),n=this.svg.selectAll(".node").data(e,function(e){var n=e.id?e.id:t.idCounter;return e.id=n,t.idCounter+=1,n}),r=n.enter().append("g").attr("class","tree__node").attr("transform",function(){return"translate("+t.sourceCoord.y+", "+t.sourceCoord.x+")"});this.moveNodesInPlace(r),this.addNodeLabels(r),n.exit().attr("transform","translate("+this.sourceCoord.y+", "+this.sourceCoord.x+")").remove()}},{key:"updateLinks",value:function(){var t=this,e=this.treeData.descendants().slice(1),n=this.svg.selectAll("path.link").data(e,function(e){var n=e.id?e.id:t.idCounter;return e.id=n,t.idCounter+=1,n});n.enter().insert("path","g").attr("class","tree__link").attr("d",function(){var e={x:t.sourceCoord.x,y:t.sourceCoord.y};return t.constructor.diagonal(e,e)}).attr("d",function(e){return t.constructor.diagonal(e,e.parent)}),n.exit().transition().duration(750).attr("d",function(){var e={y:t.sourceCoord.y,x:t.sourceCoord.x};return t.constructor.diagonal(e,e)}).remove()}}],[{key:"diagonal",value:function(t,e){return"M "+t.y+" "+t.x+"\n                  C "+(t.y+e.y)/2+" "+t.x+",\n                    "+(t.y+e.y)/2+" "+e.x+",\n                    "+e.y+" "+e.x}},{key:"calculateLabelPlacement",value:function(t){try{Math.ceil(t.x)>Math.ceil(t.parent.x)?t.labelPosition="under":Math.ceil(t.x)<Math.ceil(t.parent.x)?t.labelPosition="top":t.labelPosition=t.parent.labelPosition?t.parent.labelPosition:"top"}finally{switch(t.labelPosition){case"top":return"-1em";case"under":return"1.5em";default:return"0em"}}}}]),t}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var a=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config={width:r.width?r.width:400,height:r.height?r.height:200,posX:r.posX?r.posX:0,posY:r.posY?r.posY:0,scaleStartDate:r.scaleStartDate?r.scaleStartDate:new Date("1970-1-1"),scaleEndDate:r.scaleEndDate?r.scaleEndDate:new Date,xAxisOrientation:r.xAxisOrientation?r.xAxisOrientation:"bottom",showXAxis:null==r.showXAxis||r.showXAxis,showLegend:null==r.showLegend||r.showLegend},this.data=e,this.xAxisPadding=30,this.svg=n.append("g").attr("class","timeline-chart").attr("width",this.config.width).attr("height",this.config.height+this.xAxisPadding).attr("transform","translate("+this.config.posX+", "+this.config.posY+")"),this.x=d3.scaleTime().domain([this.config.scaleStartDate,this.config.scaleEndDate]).range([0,this.config.width-25]),this.y=d3.scaleBand().domain(e.map(function(t){return t.type})).range([this.xAxisPadding,this.config.height]).paddingInner(.25).round(!0)}return r(t,[{key:"drawXAxis",value:function(){var t=this,e=void 0;(e="top"===this.config.xAxisOrientation?d3.axisTop(this.x):d3.axisBottom(this.x)).ticks(d3.timeYear.every(10)),this.svg.append("g").attr("class","timeline-chart__axis").call(e).attr("transform",function(){return"top"===t.config.xAxisOrientation?"translate(0, -2.5)":"translate(0, "+(t.config.height-t.xAxisPadding+2.5)+")"})}},{key:"drawLegend",value:function(){var t=this.svg.append("g").attr("class","legend");t.attr("transform","translate("+(this.config.width-15)+", 0)");var e=t.append("g").attr("class","legend__category");e.append("rect").attr("class","legend__color-1").attr("width",this.y.bandwidth()/2).attr("height",this.y.bandwidth()/2),e.append("text").attr("class","legend__label").text("1987").attr("transform","translate("+(this.y.bandwidth()/2+5)+", "+(this.y.bandwidth()/2-5)+")");var n=t.append("g").attr("class","legend__category");n.append("rect").attr("class","legend__color-2").attr("width",this.y.bandwidth()/2).attr("height",this.y.bandwidth()/2).attr("transform","translate(0, "+this.y.bandwidth()/2+")"),n.append("text").attr("class","legend__label").text("1997").attr("transform","translate("+(this.y.bandwidth()/2+5)+", "+(this.y.bandwidth()-5)+")")}},{key:"calculateSectionWidth",value:function(t){return this.x(new Date(t.endDate))-this.x(new Date(t.startDate))}},{key:"calculateSectionXPos",value:function(t){return this.x(new Date(t.startDate))}},{key:"positionYearLabel",value:function(t){return"translate("+(this.x(new Date(t.startDate))+this.x(new Date(t.endDate)))/2+", "+(this.y.bandwidth()/2-4)+")"}},{key:"moveTo",value:function(t,e){this.svg.attr("transform","translate("+t+", "+e+")")}},{key:"update",value:function(){var t=this;this.config.showXAxis&&this.drawXAxis(),this.config.showLegend&&this.drawLegend();var e=this.svg.selectAll(".timeline").data(this.data).enter().append("g").attr("class","timeline");e.attr("transform",function(e){return"translate(0, "+(t.y(e.type)-t.xAxisPadding)+")"}),e.filter(function(t){return"parents"===t.type}).append("line").attr("class","timeline__separator").attr("x1",this.x(this.config.scaleStartDate)-60).attr("y1",this.y.bandwidth()+5).attr("x2",this.x(this.config.scaleEndDate)).attr("y2",this.y.bandwidth()+5).attr("stroke-width",.5).attr("stroke","black").attr("stroke-dasharray","4"),e.append("text").attr("class","timeline__title").text(function(t){return t.type}).attr("dy","1.5em").attr("dx","-5em");var n=e.selectAll("timeline__section").data(function(t){return t.data}).enter().append("g").attr("class","timeline__section");n.filter(function(t){return new Date(t.startDate).getFullYear()!==new Date(t.endDate).getFullYear()}).append("rect").attr("class","timeline__rect").attr("x",function(e){return t.calculateSectionXPos(e)}).attr("height",this.y.bandwidth()/2).attr("width",function(e){return t.calculateSectionWidth(e)}),n.filter(function(t){return new Date(t.startDate).getFullYear()===new Date(t.endDate).getFullYear()}).append("circle").attr("r",this.y.bandwidth()/4).attr("class","timeline__rect").attr("cx",function(e){return t.calculateSectionXPos(e)}).attr("cy",7.5),n.append("text").attr("class","timeline__year-label").text(function(e){return t.constructor.createYearLabel(e)}).attr("text-anchor","middle").attr("transform",function(e){return t.positionYearLabel(e)}),n.filter(function(t){return"1997"===t.cohort}).attr("transform","translate(0, "+this.y.bandwidth()/2+")"),n.filter(function(t){return"1987"===t.cohort}).select(".timeline__rect").attr("class","timeline__rect timeline__rect--87")}}],[{key:"findEarliestStartDate",value:function(t){return d3.min(t,function(t){return new Date(t.startDate)})}},{key:"findLatestEndDate",value:function(t){return d3.max(t,function(t){return new Date(t.endDate)})}},{key:"createYearLabel",value:function(t){var e=new Date(t.startDate),n=new Date(t.endDate),r=e.getMonth(),a=n.getMonth(),i=e.getFullYear(),o=n.getFullYear(),s=0===r?i:r+1+"/"+i,c=11===a?o:n.getMonth()+1+"/"+o;if(i===o){if(r===a)return s;if(0===r&&11===a)return i}return s+"—"+c}}]),t}();e.default=a}]);